-- More Monads!

-- Prelude> take 20 $ iterate (*10) 1
-- [1,10,100,1000,10000,100000,1000000,10000000,100000000,1000000000,10000000000,100000000000,1000000000000,10000000000000,100000000000000,1000000000000000,10000000000000000,100000000000000000,1000000000000000000,10000000000000000000]
-- Prelude> iterate (*10) 1 !! 5
-- 100000

import Control.Monad

-- kick a value x up or down by d
kick d x = [x-d, x+d]

fibs = 1:1:zipWith (+) fibs (tail fibs)

-- *Main Control.Monad> foldl (>>=) [0] (take 5 (map kick fibs))
-- [-12,-2,-6,4,-8,2,-2,8,-10,0,-4,6,-6,4,0,10,-10,0,-4,6,-6,4,0,10,-8,2,-2,8,-4,6,2,12]

--   SEND
-- + MORE
-- ------
--  MONEY

-- distinct digits:
-- d e y n r o m s

baseToInt :: Int -> [Int] -> Int
baseToInt b ds = foldl (\n d -> b*n + d) 0 ds

b10 = baseToInt 10

smm = do
  d <- [0..9]
  e <- [0..9]
  guard $ d /= e
  y <- [0..9]
  guard $ not (y `elem` [d,e])
  n <- [0..9]
  guard $ not (n `elem` [d,e,y])
  r <- [0..9]
  guard $ not (r `elem` [d,e,y,n])
  o <- [0..9]
  guard $ not (o `elem` [d,e,y,n,r])
  m <- [0..9]
  guard $ not (m `elem` [d,e,y,n,r,o])
  s <- [0..9]
  guard $ not (s `elem` [d,e,y,n,r,o,m])
  guard $ b10 [s,e,n,d] + b10 [m,o,r,e] == b10 [m,o,n,e,y]
  return [[s,e,n,d],[m,o,r,e],[m,o,n,e,y]]

-- *Main Control.Monad> smm 
-- [[[7,5,3,1],[0,8,2,5],[0,8,3,5,6]],
--  [[5,7,3,1],[0,6,4,7],[0,6,3,7,8]],
--  [[3,8,2,1],[0,4,6,8],[0,4,2,8,9]],
--  [[6,8,5,1],[0,7,3,8],[0,7,5,8,9]],
--  [[8,4,3,2],[0,9,1,4],[0,9,3,4,6]],
--  [[8,5,4,2],[0,9,1,5],[0,9,4,5,7]],
--  [[3,7,1,2],[0,4,6,7],[0,4,1,7,9]],
--  [[5,7,3,2],[0,6,4,7],[0,6,3,7,9]],
--  [[7,6,4,3],[0,8,2,6],[0,8,4,6,9]],
--  [[6,8,5,3],[0,7,2,8],[0,7,5,8,1]],
--  [[8,3,2,4],[0,9,1,3],[0,9,2,3,7]],
--  [[6,5,2,4],[0,7,3,5],[0,7,2,5,9]],
--  [[7,5,3,4],[0,8,2,5],[0,8,3,5,9]],
--  [[6,4,1,5],[0,7,3,4],[0,7,1,4,9]],
--  [[7,3,1,6],[0,8,2,3],[0,8,1,3,9]],
--  [[9,5,6,7],[1,0,8,5],[1,0,6,5,2]],           <---- VALID
--  [[2,8,1,7],[0,3,6,8],[0,3,1,8,5]],
--  [[6,4,1,9],[0,7,2,4],[0,7,1,4,3]],
--  [[7,4,2,9],[0,8,1,4],[0,8,2,4,3]],
--  [[7,5,3,9],[0,8,1,5],[0,8,3,5,4]],
--  [[7,6,4,9],[0,8,1,6],[0,8,4,6,5]],
--  [[3,7,1,9],[0,4,5,7],[0,4,1,7,6]],
--  [[2,8,1,9],[0,3,6,8],[0,3,1,8,7]],
--  [[3,8,2,9],[0,4,5,8],[0,4,2,8,7]],
--  [[5,8,4,9],[0,6,3,8],[0,6,4,8,7]]]
